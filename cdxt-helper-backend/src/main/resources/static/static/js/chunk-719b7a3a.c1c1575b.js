(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-719b7a3a"],{"265e":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{attrs:{type:"flex",gutter:"2"}},[s("el-col",{attrs:{span:12}},[s("div",{staticClass:"baseBox logBox"},[s("div",{staticClass:"box-header"},[s("el-row",[s("el-col",{attrs:{span:14}},[s("i",{staticClass:"iconfont icon-renwu"}),e._v("问题处理日志\n            ")]),e._v(" "),s("el-col",{attrs:{span:10}})],1)],1),e._v(" "),s("div",{staticClass:"box-main"},[s("el-row",{staticStyle:{"overflow-y":"scroll",height:"250px"}},e._l(e.logList,(function(t){return s("el-col",{key:t,staticClass:"content",attrs:{span:24}},["ISSUE_OP_LOG"==t.type?s("span",[e._v(e._s(e.$moment(t.data.gmtCreate).format("HH:MM:SS")+" "+t.data.content))]):e._e(),e._v(" "),"LOG"==t.type?s("span",[e._v(e._s(t.gmt_create+" "+t.message))]):e._e()])})),1)],1)])]),e._v(" "),s("el-col",{attrs:{span:12}},[s("div",{staticClass:"baseBox personnelBox"},[s("div",{staticClass:"box-header"},[s("el-row",[s("el-col",{attrs:{span:14}},[s("i",{staticClass:"iconfont icon-zhibanrenyuan"}),e._v("\n              问题处理人员 (在线 "+e._s(e.watcehrOnlieInfo.onlineCount)+")\n              "),"ADMIN"==e.role?s("i",{staticClass:"el-icon-setting",staticStyle:{cursor:"pointer","font-size":"18px",color:"#2196F3","margin-left":"10px"},on:{click:function(t){e.watcherSetDialogVisible=!0}}}):e._e()]),e._v(" "),s("el-col",{attrs:{span:10}})],1)],1),e._v(" "),s("div",{staticClass:"box-main"},[s("el-table",{staticClass:"watcher-table",staticStyle:{width:"100%",height:"250px",overflow:"scroll"},attrs:{data:e.watcherList}},[s("el-table-column",{attrs:{prop:"trueName",label:"姓名",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"module",label:"负责模块",width:"100",formatter:e.moduleFormat}}),e._v(" "),s("el-table-column",{attrs:{label:"值班结束时间"}},[e._v(e._s(e.$moment(e.gmtEndTime).format("YYY-MM-DD HH:MM:SS")))]),e._v(" "),s("el-table-column",{attrs:{label:"进行中的任务数",prop:"processingTaskNum"}})],1)],1)])])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:24}},[s("div",{staticClass:"baseBox issueBox"},[s("div",{staticClass:"box-header"},[s("el-row",[s("el-col",{attrs:{span:14}},[s("i",{staticClass:"iconfont icon-imagevector"}),e._v("问题处理日志\n            ")]),e._v(" "),s("el-col",{attrs:{span:10}})],1)],1),e._v(" "),s("div",{staticClass:"box-main"},[s("el-button",{on:{click:function(t){e.issuePostForm.isAdditional=!1,e.showDiaglog("issuePost")}}},[e._v("发布问题")]),e._v(" "),s("el-button",{on:{click:function(t){e.issuePostForm.isAdditional=!0,e.showDiaglog("issueAdditional")}}},[e._v("补录已完成问题")]),e._v(" "),s("i",{staticClass:"iconfont icon-shuaxincopy",staticStyle:{"margin-left":"20px"}}),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.issueTable.records,"max-height":"400"}},[s("el-table-column",{attrs:{fixed:"",prop:"title",label:"标题",width:"300"}}),e._v(" "),s("el-table-column",{attrs:{prop:"hospitalName",label:"医院",width:"200"}}),e._v(" "),s("el-table-column",{attrs:{prop:"hospitalBranch",label:"所属分支",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"module",label:"所属模块",width:"120",formatter:e.moduleFormat}}),e._v(" "),s("el-table-column",{attrs:{prop:"priorityCode",label:"紧急程度",width:"120",formatter:e.priorityCodeFormat}}),e._v(" "),s("el-table-column",{attrs:{prop:"state",label:"任务状态",width:"120",formatter:e.stateFormat}}),e._v(" "),s("el-table-column",{attrs:{label:"发布时间",width:"150"}},[e._v(e._s(e.$moment(e.gmtCreate).format("YYYY-MM-DD HH:MM:SS")))]),e._v(" "),s("el-table-column",{attrs:{label:"处理时间",width:"150"}},[e._v(e._s(e.$moment(e.gmtCompletion).format("YYYY-MM-DD HH:MM:SS")))]),e._v(" "),s("el-table-column",{attrs:{prop:"puser",label:"发布人员",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"duser",label:"处理人员",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==e.issueTable.records[t.$index].state&&"DEVELOPER"==e.role?s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"开始",placement:"top-start"}},[s("i",{staticClass:"iconfont icon-xiaoyan",on:{click:function(s){e.issueUpdateForm.id=e.issueTable.records[t.$index].id,e.issueStart()}}})]):e._e(),e._v(" "),"DEVELOPER"!=e.role||0!=e.issueTable.records[t.$index].state&&1!=e.issueTable.records[t.$index].state?e._e():s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"指派",placement:"top-start"}},[s("i",{staticClass:"iconfont icon-zhipai",on:{click:function(s){e.issueUpdateForm.id=e.issueTable.records[t.$index].id,e.showDiaglog("issueAssignUser")}}})]),e._v(" "),1==e.issueTable.records[t.$index].state&&"DEVELOPER"==e.role?s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"完成",placement:"top-start"}},[s("i",{staticClass:"iconfont icon-wancheng5",on:{click:function(s){e.issueUpdateForm.id=e.issueTable.records[t.$index].id,e.showDiaglog("issueCompletion")}}})]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"详情",placement:"top-start"}},[s("i",{staticClass:"iconfont icon-ziyuan",on:{click:function(s){return e.showIssueDetailDialog(e.issueTable.records[t.$index].id)}}})]),e._v(" "),2==e.issueTable.records[t.$index].state&&"AFTERSAFE"==e.role?s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"审核",placement:"top-start"}},[s("i",{staticClass:"iconfont icon-xiaoyanbaocun",on:{click:function(s){e.issueUpdateForm.id=e.issueTable.records[t.$index].id,e.showDiaglog("issueAuth")}}})]):e._e()]}}])})],1),e._v(" "),s("el-pagination",{attrs:{"current-page":e.issueTable.pageNum,"page-sizes":[10,20,50,100],"page-size":e.issueTable.pageSize,layout:"total, sizes, prev, pager, next",total:e.issueTable.total},on:{"size-change":e.issuePagehandleSizeChange,"current-change":e.issuePagehandleCurrentChange}})],1)])])],1),e._v(" "),s("el-dialog",{attrs:{title:e.issueDialogConfig.title,visible:e.commonDialogVisible,"close-on-click-modal":!1,width:e.issueDialogConfig.width},on:{"update:visible":function(t){e.commonDialogVisible=t}}},["issuePost"==e.issueDialogConfig.name||"issueAdditional"==e.issueDialogConfig.name?s("el-form",{ref:"issuePostForm",attrs:{model:e.issuePostForm,rules:e.issuePostFormRules}},[s("el-row",{attrs:{gutter:"10"}},[s("el-col",{attrs:{span:7}},[s("el-form-item",{attrs:{prop:"title"}},[s("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.issuePostForm.title,callback:function(t){e.$set(e.issuePostForm,"title",t)},expression:"issuePostForm.title"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("el-form-item",{attrs:{prop:"module"}},[s("el-select",{attrs:{placeholder:"请选择问题所在模块"},model:{value:e.issuePostForm.module,callback:function(t){e.$set(e.issuePostForm,"module",t)},expression:"issuePostForm.module"}},e._l(e.moduleList,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("el-form-item",{attrs:{prop:"priorityCode"}},[s("el-select",{attrs:{placeholder:"请选择优先级"},model:{value:e.issuePostForm.priorityCode,callback:function(t){e.$set(e.issuePostForm,"priorityCode",t)},expression:"issuePostForm.priorityCode"}},e._l(e.priorityCodeList,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("el-form-item",{attrs:{prop:"duid"}},[s("UserSearchSelect",{attrs:{role:e.DEVELOPER},model:{value:e.issuePostForm.duid,callback:function(t){e.$set(e.issuePostForm,"duid",t)},expression:"issuePostForm.duid"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-form-item",{attrs:{prop:"hospitalId"}},[s("HospitalSearchSelect",{model:{value:e.issuePostForm.hospitalId,callback:function(t){e.$set(e.issuePostForm,"hospitalId",t)},expression:"issuePostForm.hospitalId"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:24}},[s("quill-editor",{ref:"quillEditor",attrs:{options:e.editorOption},on:{focus:function(t){return e.onEditorFocus(t)},blur:function(t){return e.onEditorBlur(t)},change:function(t){return e.onEditorChange(t)}},model:{value:e.issuePostForm.detail,callback:function(t){e.$set(e.issuePostForm,"detail",t)},expression:"issuePostForm.detail"}})],1)],1)],1):e._e(),e._v(" "),"issueAssignUser"==e.issueDialogConfig.name||"issueCompletion"==e.issueDialogConfig.name||"issueAuth"==e.issueDialogConfig.name?s("el-form",{ref:"issueUpdateForm",attrs:{model:e.issueUpdateForm}},[s("el-row",{attrs:{gutter:"10"}},["issueCompletion"==e.issueDialogConfig.name?s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"问题分类"}},[s("el-select",{attrs:{filterable:"","default-first-option":"",placeholder:"请选择问题类型"},model:{value:e.issueUpdateForm.classification,callback:function(t){e.$set(e.issueUpdateForm,"classification",t)},expression:"issueUpdateForm.classification"}},e._l(e.classificationList,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1):e._e(),e._v(" "),"issueCompletion"==e.issueDialogConfig.name?s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"是否为需求"}},[s("el-select",{attrs:{"default-first-option":"",placeholder:"选择是否为需求(可为空)"},model:{value:e.issueUpdateForm.isDemand,callback:function(t){e.$set(e.issueUpdateForm,"isDemand",t)},expression:"issueUpdateForm.isDemand"}},[s("el-option",{key:"0",attrs:{label:"否",value:"0"}}),e._v(" "),s("el-option",{key:"1",attrs:{label:"是",value:"1"}})],1)],1)],1):e._e(),e._v(" "),"issueAssignUser"==e.issueDialogConfig.name?s("el-col",{attrs:{span:15}},[s("el-form-item",[s("UserSearchSelect",{attrs:{role:e.DEVELOPER},model:{value:e.issueUpdateForm.duid,callback:function(t){e.$set(e.issueUpdateForm,"duid",t)},expression:"issueUpdateForm.duid"}})],1)],1):e._e(),e._v(" "),s("el-col",{attrs:{span:24}},[s("quill-editor",{ref:"quillEditor",attrs:{options:e.editorOption},on:{focus:function(t){return e.onEditorFocus(t)},blur:function(t){return e.onEditorBlur(t)},change:function(t){return e.onEditorChange(t)}},model:{value:e.issueUpdateForm.feedBackText,callback:function(t){e.$set(e.issueUpdateForm,"feedBackText",t)},expression:"issueUpdateForm.feedBackText"}})],1),e._v(" "),"issueAssignUser"==e.issueDialogConfig.name?s("el-col",{staticStyle:{color:"red","margin-top":"20px"},attrs:{span:24}},[s("span",[e._v("* 请仔细确认是否指派，指派之后任务会从您的列表中移除")])]):e._e()],1)],1):e._e(),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){return e.resetForm("issuePost"==e.issueDialogConfig.name?"issuePostForm":"issueUpdateForm")}}},[e._v("清空")]),e._v(" "),"issuePost"==e.issueDialogConfig.name||"issueAdditional"==e.issueDialogConfig.name?s("el-button",{on:{click:function(t){return e.commonSubmit("issuePostForm")}}},[e._v("发布")]):e._e(),e._v(" "),"issueAuth"==e.issueDialogConfig.name?s("el-button",{on:{click:e.issueReturn}},[e._v("退回")]):e._e(),e._v(" "),"issueAuth"==e.issueDialogConfig.name?s("el-button",{on:{click:e.issueAuthAccess}},[e._v("审核通过")]):e._e(),e._v(" "),"issueAssignUser"==e.issueDialogConfig.name?s("el-button",{on:{click:function(t){return e.issueAssign()}}},[e._v("确认指派")]):e._e(),e._v(" "),"issueCompletion"==e.issueDialogConfig.name?s("el-button",{on:{click:e.issueComplet}},[e._v("确认完成")]):e._e()],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"问题详情",visible:e.issueDetailDialogVisible,width:"80%"},on:{"update:visible":function(t){e.issueDetailDialogVisible=t}}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-divider",{attrs:{"content-position":"left"}},[e._v("问题详情")]),e._v(" "),s("div",{domProps:{innerHTML:e._s(e.issueDetail.detail)}})],1),e._v(" "),s("el-col",{attrs:{span:24}},[s("el-divider",{attrs:{"content-position":"left"}},[e._v("问题操作日志")]),e._v(" "),s("el-timeline",e._l(e.issueDetail.opLogs,(function(t,i){return s("el-timeline-item",{key:i,attrs:{timestamp:e.$moment(t.gmtCreate).format("YYYY-MM-DD HH:MM:SS")}},[s("el-card",[s("h4",[e._v(e._s(t.content))]),e._v(" "),""!=t.extrasText&&null!=t.extrasText?s("div",{domProps:{innerHTML:e._s(t.extrasText)}}):e._e()])],1)})),1)],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"值班人员设置",visible:e.watcherSetDialogVisible,width:"40%"},on:{"update:visible":function(t){e.watcherSetDialogVisible=t}}},[s("el-form",{ref:"watcherSetForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.watcherSetForm,rules:e.watcherSetFormRules}},[s("el-form-item",{attrs:{label:"用户",prop:"uid"}},[s("UserSearchSelect",{attrs:{role:e.DEVELOPER},model:{value:e.watcherSetForm.uid,callback:function(t){e.$set(e.watcherSetForm,"uid",t)},expression:"watcherSetForm.uid"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"值班结束时间",prop:"gmtEndTime"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.watcherSetForm.gmtEndTime,callback:function(t){e.$set(e.watcherSetForm,"gmtEndTime",t)},expression:"watcherSetForm.gmtEndTime"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){return e.resetForm("watcherSetForm")}}},[e._v("清空")]),e._v(" "),s("el-button",{on:{click:function(t){return e.commonSubmit("watcherSetForm")}}},[e._v("设置")])],1)],1)],1)},a=[],o=(s("309f"),s("0b53"),s("06a2"),s("ec25"),s("cc57"),s("5ab2"),s("e10e"),s("6d57"),s("2b45"),s("6a61"),s("cf7f")),r=s("ce3c"),n=s("b881"),l=(s("7e41"),s("0126"),s("b775"));function u(e){return Object(l["a"])({url:"/after-safe/issue/release",method:"POST",data:e})}function c(e){return Object(l["a"])({url:"/after-safe/issue/updateState",method:"PUT",data:e})}function d(e){return Object(l["a"])({url:"/after-safe/issue/assignUser",method:"PUT",data:e})}function m(e){return Object(l["a"])({url:"/after-safe/issue/list",method:"POST",data:e})}function p(){return Object(l["a"])({url:"/user/watcher/list",method:"GET"})}function h(e){return Object(l["a"])({url:"/after-safe/issue/detail/"+e,method:"GET"})}function f(){return Object(l["a"])({url:"/after-safe/issue/onlineUser/state",method:"GET"})}var g=s("41db"),b=s("c24f"),v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入用户名称搜索","remote-method":e.searchUserList,loading:e.loading},on:{change:e.valueChangeEvent},model:{value:e.uid,callback:function(t){e.uid=t},expression:"uid"}},e._l(e.userList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.true_name,value:e.id}})})),1)],1)},w=[],_={name:"UserSearchSelect",props:["value"],model:{prop:"value",event:"change"},data:function(){return{userList:[],uid:"",loading:!1}},methods:{searchUserList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,Object(b["a"])(this.role,t);case 3:s=e.sent,console.log(s),this.userList=s,this.loading=!1;case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),valueChangeEvent:function(e){this.$emit("change",e)}}},S=_,k=s("9ca4"),F=Object(k["a"])(S,v,w,!1,null,null,null),y=F.exports,x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入医院名称搜索","remote-method":e.searchHospitalList,loading:e.loading},on:{change:e.valueChangeEvent},model:{value:e.hospitalId,callback:function(t){e.hospitalId=t},expression:"hospitalId"}},e._l(e.hospitalList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)},C=[];function D(e){return Object(l["a"])({url:"/common/hospitals",method:"GET",params:e})}var O={name:"HospitalSearchSelect",data:function(){return{hospitalList:[],hospitalId:"",loading:!1}},props:["value"],model:{prop:"value",event:"change"},methods:{searchHospitalList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,D(t);case 3:s=e.sent,this.hospitalList=s.records,this.loading=!1;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),valueChangeEvent:function(e){this.$emit("change",e)}}},P=O,U=Object(k["a"])(P,x,C,!1,null,null,null),E=U.exports,L=s("f9bb"),j=s("52c1");s("ed08");function T(e,t){var s;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(s=$(e))||t&&e&&"number"===typeof e.length){s&&(e=s);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,n=!1;return{s:function(){s=e[Symbol.iterator]()},n:function(){var e=s.next();return r=e.done,e},e:function(e){n=!0,o=e},f:function(){try{r||null==s.return||s.return()}finally{if(n)throw o}}}}function $(e,t){if(e){if("string"===typeof e)return I(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}function R(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function A(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?R(Object(s),!0).forEach((function(t){Object(r["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):R(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var H={issuePost:{width:"80%",title:"问题发布"},issueAdditional:{width:"80%",title:"问题补录"},issueAssignUser:{width:"50%",title:"问题指派"},issueCompletion:{width:"50%",title:"问题完成确认"},issueAuth:{width:"50%",title:"问题审核"}},M={name:"issueManager",components:{quillEditor:n["quillEditor"],UserSearchSelect:y,HospitalSearchSelect:E},data:function(){return{classificationList:[],watcherSetDialogVisible:!1,issueDetailDialogVisible:!1,watcehrOnlieInfo:{},websock:null,commonDialogVisible:!1,logList:[],watcherList:[],issueDetail:{},watcherSetForm:{uid:"",gmtEndTime:null},issueUpdateForm:{title:"",duid:"",feedBackText:""},issuePostForm:{title:"",duid:"",module:"",hospitalId:"",detail:"",priorityCode:"",isDemand:"",classification:""},issuePostIsAddtional:!1,hospitalSelectLoading:!1,moduleList:[],priorityCodeList:[],hospitalList:[],issuePostFormRules:{title:[{required:!0,message:"请输入活动名称",trigger:"blur"}],hospitalId:[{required:!0,message:"请输入医院名称",trigger:"change"}],priorityCode:[{required:!0,message:"请选择优先级代码",trigger:"change"}],module:[{required:!0,message:"请选择问题模块",trigger:"change"}],duid:[{required:!0,message:"请选择处理人员",trigger:"change"}]},watcherSetFormRules:{uid:[{required:!0,message:"值班人员不能为空",trigger:"change"}],gmtEndTime:[{required:!0,message:"值班结束时间不能为空",trigger:"change"}]},issueSearchParams:{pageNum:1,pageSize:10},issueTable:{pageNum:1,pageSize:10,total:0,records:[]},issueDialogConfig:{},editorOption:{}}},methods:{moduleFormat:function(e,t){switch(e.module){case"1":return"住院";case"2":return"护士";case"3":return"药品";case"4":return"门诊";default:}},priorityCodeFormat:function(e,t){switch(e.priorityCode){case"1":return"低";case"2":return"中";case"3":return"高";case"4":return"紧急";default:}},stateFormat:function(e,t){switch(e.state){case"0":return"未处理";case"1":return"处理中";case"2":return"审核中";case"3":return"已处理";default:}},hospitalValueBindEvent:function(e){},initWebSocket:function(){var e="ws://10.158.3.216:9026/wss/afs/issue/"+this.uid;this.websock=new WebSocket(e),this.websock.onmessage=this.websocketonmessage,this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onclose=this.websocketclose},websocketonopen:function(){},websocketonerror:function(){this.initWebSocket()},websocketonmessage:function(e){console.log("wss接受消息错"),console.log(e);var t=JSON.parse(e.data);console.log(t),"200"==t.code?this.wssDispatcher(t.data):console.log("wss接受消息错误: "+t.msg)},websocketsend:function(e){this.websock.send(e)},websocketclose:function(e){console.log("断开连接",e)},issueOpLogHandler:function(e){console.log("操作消息处理"),console.log(e),this.logList.push(e),this.searchIssue(this.issueSearchParams={}),this.getWatcherList()},logHandler:function(e){var t={message:e,type:"LOG",gmt_create:this.$moment(new Date).format("HH:MM:SS")};this.logList.push(t),this.refreshWatherOnlieState()},wssDispatcher:function(e){switch(e.type){case"LOG":this.logHandler(e.data);break;case"ISSUE_OP_LOG":this.issueOpLogHandler(e);break;default:console.log("未知的消息类型")}},commonSubmit:function(e){var t=this,s=!1;this.$refs[e].validate((function(i){if(i){switch(e){case"issuePostForm":s=t.postIssue(A({},t.issuePostForm));break;case"watcherSetForm":s=t.setWatcher(A({},t.watcherSetForm));default:}return s&&t.resetForm(e),!0}return console.log("error submit!!"),!1}))},resetForm:function(e){this.$refs[e].resetFields(),this.issuePostForm.duid="",this.issuePostForm.detail="",this.issuePostForm.hospitalId="",this.issueUpdateForm.duid="",this.issueUpdateForm.feedBackText="",this.watcherSetForm.uid=""},postIssue:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=u(t),console.log("res:",s),s&&(this.commonDialogVisible=!1,this.$message({message:"上传成功！",type:"success"})),e.abrupt("return",s);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),updateIssue:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=updateIssue(this.issueUpdateForm),t&&(this.commonDialogVisible=!1,this.$message({message:"更新成功！",type:"success"}));case 2:case"end":return e.stop()}}),e,this)})))),searchIssue:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(this.issueSearchParams),console.log("ces"),e.next=4,m(this.issueSearchParams);case 4:t=e.sent,this.issueTable=t;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),showIssueDetailDialog:function(e){this.getIssueDetail(e),this.issueDetailDialogVisible=!0},getIssueDetail:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:s=e.sent,this.issueDetail=s;case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),searchHospital:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(t),""===t){e.next=10;break}return this.hospitalSelectLoading=!0,e.next=5,Object(g["c"])({text:t,pageNum:1,pageSize:1e3});case 5:s=e.sent,this.hospitalList=s.records,this.hospitalSelectLoading=!1,e.next=11;break;case 10:this.hospitalList=[];case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),hospitalSelectChangeEvt:function(){var e=this;this.tempForm.hospital=this.hospitals.filter((function(t){return t.id==e.tempForm.hospital.id}))[0],this.showDUserSelect=!0},issuePagehandleSizeChange:function(e){this.issueSearchParams.pageSize=e,this.searchIssue()},issuePagehandleCurrentChange:function(e){this.issueSearchParams.pageNum=e,this.searchIssue()},getWatcherList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:t=e.sent,this.watcherList=t;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),setWatcher:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(b["e"])(t);case 2:return s=e.sent,s&&(this.$message({message:"设置成功！",type:"success"}),this.watcherSetDialogVisible=!1),e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),showDiaglog:function(e){console.log(e),console.log(H),this.issueDialogConfig=H[e],this.commonDialogVisible=!0,this.issueDialogConfig.name=e},issueStart:function(){this.issueUpdateForm.state=1,this.updateIssueState()},issueComplet:function(){this.issueUpdateForm.state=2,this.updateIssueState()},issueReturn:function(){this.issueUpdateForm.state=1,this.updateIssueState()},issueAuthAccess:function(){this.issueUpdateForm.state=3,this.updateIssueState()},updateIssueState:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(void 0==this.issueUpdateForm.state||""==this.issueUpdateForm.state){e.next=7;break}return e.next=3,c(this.issueUpdateForm);case 3:t=e.sent,t&&(this.$message({message:"操作成功",type:"success"}),this.resetForm("issueUpdateForm"),this.commonDialogVisible=!1),e.next=8;break;case 7:this.$message({message:"任务状态不能为空",type:"error"});case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),issueAssign:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(void 0!=this.issueUpdateForm.duid&&0!=this.issueUpdateForm.duid.length){e.next=3;break}return this.$message({message:"任务处理人员信息不能为空",type:"error"}),e.abrupt("return");case 3:return e.next=5,d(this.issueUpdateForm);case 5:t=e.sent,console.log(t),t&&(this.$message({message:"任务指派成功",type:"success"}),this.resetForm("issueUpdateForm"),this.commonDialogVisible=!1);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),refreshWatherOnlieState:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:t=e.sent,this.watcehrOnlieInfo=t,this.watcherList.forEach((function(e,t,i){var a,o=T(s.watcehrOnlieInfo.onlieUserList);try{for(o.s();!(a=o.n()).done;){var r=a.value,n=e.uid==r;s.watcherList[t].isOnline=n}}catch(l){o.e(l)}finally{o.f()}})),console.log(this.watcherList);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){var e=this;this.moduleList=[{label:"住院",value:"1"},{label:"护士",value:"2"},{label:"药品",value:"3"},{label:"门诊",value:"4"}],this.priorityCodeList=[{label:"低",value:"1"},{label:"中",value:"2"},{label:"高",value:"3"},{label:"紧急",value:"4"}],this.classificationList=[{label:"业务逻辑问题",value:"1"},{label:"功能操作问题",value:"2"},{label:"功能优化问题",value:"3"},{label:"交互逻辑问题",value:"4"},{label:"数据问题",value:"5"},{label:"兼容性问题",value:"6"},{label:"性能优化问题",value:"7"},{label:"安全问题",value:"8"},{label:"接口异常",value:"9"},{label:"环境异常",value:"10"},{label:"其他",value:"11"}],this.searchIssue(this.issueSearchParams={}),this.getWatcherList(),this.refreshWatherOnlieState(),this.initWebSocket(),this.editorOption=Object(L["quillRedefine"])({uploadConfig:{action:"/file/upload",name:"file",header:function(t,s){t.setRequestHeader("X-token",e.token),s.append("X-token",e.token)},res:function(e){if(200==e.code)return e.data.fileDownloadUri}},theme:"snow"})},computed:A({},Object(j["b"])({uid:"uid",username:"name",role:"role",token:"token"})),destroyed:function(){this.websock.close()}},V=M,q=(s("b8fb"),Object(k["a"])(V,i,a,!1,null,"56e93af5",null));t["default"]=q.exports},"41db":function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return r})),s.d(t,"e",(function(){return n})),s.d(t,"d",(function(){return l}));var i=s("b775");function a(e){return Object(i["a"])({url:"/deploy/post",method:"PUT",data:e})}function o(e){return Object(i["a"])({url:"/common/hospitals",method:"GET",params:e})}function r(e){return Object(i["a"])({url:"/deploy/list",method:"post",data:e})}function n(e){return Object(i["a"])({url:"/deploy/update/state",method:"post",params:e})}function l(e){return Object(i["a"])({url:"/deploy/savaOrUpdateHospital",method:"post",data:e})}},b8fb:function(e,t,s){"use strict";var i=s("e12c"),a=s.n(i);a.a},e12c:function(e,t,s){}}]);